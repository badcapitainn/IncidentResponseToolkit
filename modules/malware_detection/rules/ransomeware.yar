rule Ransomware_Generic {
    meta:
        description = "Detects ransomware behavior"
        author = "IRAT Project"

    strings:
        $ransom_strings = /(ransom|pay \d+ (bitcoin|btc)|decrypt your files|your files are encrypted)/ nocase
        $crypto_apis = /(CryptEncrypt|CryptDecrypt|AesManaged|RijndaelManaged)/ nocase
        $file_extension_changes = /\.(encrypted|locked|crypted|ransom)/ nocase

    condition:
        ($ransom_strings and $crypto_apis) or $file_extension_changes
}

rule WannaCry_Variant {
    meta:
        description = "Detects WannaCry-like ransomware"
        author = "IRAT Project"

    strings:
        $wcry_string = "WANACRY!" wide
        $kill_switch = "www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com"
        $resource_name = "WANACRY"

    condition:
        any of them
}