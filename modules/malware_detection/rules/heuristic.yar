rule Heuristic_Executable_Packing {
    meta:
        description = "Detects packed executables"
        author = "IRAT Project"

    strings:
        $packer_sections = /(UPX|ASPack|PECompact|FSG|Themida)/ nocase
        $entropy_high = "ENTROPY_HIGH"  // This would be calculated in code
        $few_imports = "IMPORTS_FEW"    // This would be calculated in code

    condition:
        $packer_sections or ($entropy_high and $few_imports)
}

rule Heuristic_AntiDebugging {
    meta:
        description = "Detects anti-debugging techniques"
        author = "IRAT Project"

    strings:
        $anti_debug = /(IsDebuggerPresent|CheckRemoteDebuggerPresent|OutputDebugString|NtGlobalFlag)/ nocase
        $timing_checks = /(RDTSC|QueryPerformanceCounter|GetTickCount)/ nocase

    condition:
        $anti_debug and $timing_checks
}

rule Heuristic_Code_Injection {
    meta:
        description = "Detects code injection techniques"
        author = "IRAT Project"

    strings:
        $injection_apis = /(CreateRemoteThread|WriteProcessMemory|VirtualAllocEx|NtCreateThreadEx)/ nocase
        $process_enum = /(EnumProcesses|Process32First|CreateToolhelp32Snapshot)/ nocase

    condition:
        $injection_apis and $process_enum
}