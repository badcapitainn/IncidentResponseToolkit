rule Trojan_Generic {
    meta:
        description = "Generic trojan detection"
        author = "IRAT Project"

    strings:
        $trojan_strings = /(trojan|backdoor|rat|remote access)/ nocase
        $cnc_ips = /\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}:\d{1,5}/  // IP:Port pattern
        $http_cnc = /http:\/\/[^\s]+/ nocase

    condition:
        $trojan_strings and ($cnc_ips or $http_cnc)
}

rule Banking_Trojan {
    meta:
        description = "Targets banking trojans"
        author = "IRAT Project"

    strings:
        $banking_domains = /(paypal|bankof|wellsfargo|chase|citibank|hsbc)/ nocase
        $injection_code = /(SetWindowsHook|CreateRemoteThread|VirtualAllocEx)/ nocase

    condition:
        $banking_domains and $injection_code
}