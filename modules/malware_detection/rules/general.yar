rule General_Malware_Indicators {
    meta:
        description = "General indicators of malicious files"
        author = "IRAT Project"
        date = "2024"

    strings:
        $mz = "MZ"  // PE header
        $pe_header = "PE\x00\x00"
        $executable_extensions = /\.(exe|dll|sys|bat|cmd|ps1|vbs|js)$/i
        $suspicious_strings = /(malware|virus|trojan|ransom|spyware|keylogger|backdoor|exploit)/ nocase
        $hex_pattern = { 6A 40 68 00 30 00 00 6A 14 8D 91 }

    condition:
        ($mz at 0 and $pe_header in (0..1024)) and
        ($executable_extensions or $suspicious_strings or $hex_pattern)
}

rule Suspicious_Embedded_Scripts {
    meta:
        description = "Detects embedded scripts in files"
        author = "IRAT Project"

    strings:
        $powershell = "powershell" nocase
        $cmd = "cmd.exe" nocase
        $wscript = "wscript" nocase
        $vba = "Sub AutoOpen()" nocase
        $js_eval = "eval(" nocase

    condition:
        any of them
}