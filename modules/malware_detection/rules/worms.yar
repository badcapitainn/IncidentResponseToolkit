rule Worm_Propagation {
    meta:
        description = "Detects worm propagation techniques"
        author = "IRAT Project"

    strings:
        $network_shares = /(net use|net share|\\\\[^\s]+\\[^\s]+)/ nocase
        $mass_mailing = /(CDO.Message|SMTP.Send|mailto:)/ nocase
        $autorun = "[autorun]" nocase

    condition:
        any of ($network_shares, $mass_mailing) or ($autorun and $network_shares)
}

rule Conficker_Variant {
    meta:
        description = "Detects Conficker-like worms"
        author = "IRAT Project"

    strings:
        $mutex = "Conficker" wide
        $domain_gen = /[a-z]{8,16}\.(com|net|org|info)/ nocase
        $svchost_injection = "svchost.exe -k netsvcs" wide

    condition:
        any of them
}